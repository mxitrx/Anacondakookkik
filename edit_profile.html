<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>р╕гр╕░р╕Ър╕Ър╣Ар╕Бр╣Зр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╕йр╕Хр╕гр╕Бр╕г</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
  <div class="container" style="text-align:center;">
    <h2>р╣Вр╕Ыр╕гр╣Др╕Яр╕ер╣М</h2>
    <form id="profileForm">
      <label>ЁЯСд р╕Кр╕╖р╣Ир╕нр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й:</label>
      <input type="text" name="name" required>
      
      <label>ЁЯУз Email:</label>
      <input type="email" name="address" required>
      
      <label>ЁЯУЮ Phone:</label>
      <input type="text" name="phone" required>
      
      <label>ЁЯОВ р╕нр╕▓р╕вр╕╕:</label>
      <input type="number" name="age" required>

      <input type="hidden" name="id" value="0"> <!-- row index -->
      <button type="submit">р╕нр╕▒р╕Юр╣Ар╕Фр╕Хр╣Вр╕Ыр╕гр╣Др╕Яр╕ер╣М</button>
    </form>
  </div>

  <div class="navbar">
    <a href="index.html">ЁЯПа<span>р╕лр╕Щр╣Йр╕▓р╕лр╕ер╕▒р╕Б</span></a>
    <a href="add.html">тЮХ<span>р╣Ар╕Юр╕┤р╣Ир╕б</span></a>
    <a href="track.html">ЁЯФФ<span>р╕Хр╕┤р╕Фр╕Хр╕▓р╕б</span></a>
    <a href="profile.html" class="active">ЁЯСд<span>р╣Вр╕Ыр╕гр╣Др╕Яр╕ер╣М</span></a>
  </div>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbx6DaNh5fhG26I7yi8XMi8k00VzKiaYtGHDmJpaM6XAM5X5H3dRNkeh_-330ey32_N7/exec"; // тЬЕ р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Ар╕Ыр╣Зр╕Щ URL р╕Ир╕гр╕┤р╕З
    
    // р╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Вр╕Ыр╕гр╣Др╕Яр╕ер╣М (р╣Бр╕Др╣Ир╣Бр╕Цр╕зр╣Бр╕гр╕Б)
    fetch(API_URL)
      .then(res => res.json())
      .then(data => {
        if(data.length > 0){
          let user = data[0]; // р╣Гр╕Кр╣Й record р╣Бр╕гр╕Бр╣Ар╕Ыр╣Зр╕Щр╣Вр╕Ыр╕гр╣Др╕Яр╕ер╣М
          document.querySelector("[name='name']").value = user.name;
          document.querySelector("[name='age']").value = user.age;
          document.querySelector("[name='address']").value = user.address;
          document.querySelector("[name='phone']").value = user.phone;
          document.querySelector("[name='id']").value = user.id;
        }
      });

    // р╕нр╕▒р╕Юр╣Ар╕Фр╕Хр╕Вр╣Йр╕нр╕бр╕╣р╕е
    document.getElementById("profileForm").addEventListener("submit", function(e){
      e.preventDefault();
      let data = {
        id: this.id.value,
        name: this.name.value,
        age: this.age.value,
        address: this.address.value,
        phone: this.phone.value
      };
      fetch(API_URL, {
        method: "PUT",
        body: JSON.stringify(data)
      })
      .then(res => res.text())
      .then(txt => alert("тЬЕ р╕нр╕▒р╕Юр╣Ар╕Фр╕Хр╣Вр╕Ыр╕гр╣Др╕Яр╕ер╣Мр╕кр╕│р╣Ар╕гр╣Зр╕И!"))
      .catch(err => alert("тЭМ Error: " + err));
    });
  </script>
</body>
</html>
